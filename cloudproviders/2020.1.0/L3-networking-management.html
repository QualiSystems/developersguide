<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width">
        <link rel="search" type="application/opensearchdescription+xml" title="CloudShell DevGuide" href="/opensearch.xml" />
        <title>CloudShell Developer Guide : L3 Network Connectivity</title>
        <meta name="description" content="">
        <link rel="shortcut icon" type="image/png" href="/favicon.png?">
        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
        <link rel="stylesheet" href="/css/main.css">
        <link rel="stylesheet" href="/css/prism.css">
        <link rel="stylesheet" href="/css/QualiStyle.css">
        <link rel="stylesheet" href="/css/samples.css">
        <link rel="stylesheet" href="/css/normalize.css">
        <link rel="stylesheet" href="/css/test-hot-block.webflow.css">


        <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
        <script src="/js/jquery-3.1.0.min.js"></script>
        <script src="/js/modernizr.js"></script>
        <script src="/js/webflow.js"></script>
        <script src="/js/version-redirect.js"></script>

        
    </head>
    <body>
        <div id="header">
            <div class="container">
                <div class="row">
    <div class="col-md-3 col-sm-4">
        <a class="brand" href="/">
            <img alt="CloudShell Logo" src="/assets/logo.png" />
            CloudShell <small>Developer Guide</small>
        </a>
    </div>
    <div class="col-md-9 col-sm-8">
        
		  
        <form class="search" action="/search/2020.1.0/search.html">
            <input class="input" id="search-query" type="text" name="q" placeholder="Search" />
            <input class="button" type="submit" value="Search"></input>
        </form>
    </div>
</div>

            </div>
        </div>
        <div class="container">
            <div class="row"> 
            	
                <!-- <div class="col-md-3"><span> Sveta </span></div> -->
                               
                
                
                    <div id="navigation" class="col-md-3 col-sm-4">
                        <span><strong>CloudShell Version: </strong></span>
                        <div id="versions">
                            <div class="form-group" onchange="versionChange(this)">
	<select class="form-control" id="version">
   
   	
		
	
		  
	  <option value="9.3.0">9.3.0</option>
	
	
		  
	  <option value="9.2.0">9.2.0</option>
	
	
		  
	  <option value="9.1.0">9.1.0</option>
	
	
		  
	  <option value="9.0.0">9.0.0</option>
	
	
		  
	  <option value="8.3.0">8.3.0</option>
	
	
	
	  <option value="2020.1.0" selected>2020.1.0</option>
	
	
	</select>
</div>
                        </div>
                        <ul class="nav nav-list" style="margin-top: -30px;">  
     
        
           <li class="nav-header"></li>
			  
           
           
        
           <li class="nav-header">Introduction</li>
			  
           
           
               
			      
					               
               	
                       <li data-page-id="_introduction/2020.1.0/the-cloudshell-devguide.md" data-order="1"><a href="/introduction/2020.1.0/the-cloudshell-devguide.html">The CloudShell DevGuide</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_introduction/2020.1.0/setting-up-the-development-ide.md" data-order="2"><a href="/introduction/2020.1.0/setting-up-the-development-ide.html">Setting up the Development Environment</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
        
           <li class="nav-header">Extending cloudshell with shells</li>
			  
           
           
               
			      
					               
               	
                       <li data-page-id="_shells/2020.1.0/getting-started.md" data-order="1"><a href="/shells/2020.1.0/getting-started.html">Getting Started</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_shells/2020.1.0/shell-driver-overview.md" data-order="2"><a href="/shells/2020.1.0/shell-driver-overview.html">Shell Drivers Overview</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_shells/2020.1.0/the-shell-project.md" data-order="3"><a href="/shells/2020.1.0/the-shell-project.html">The Shell Project Guide</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_shells/2020.1.0/modeling-the-shell.md" data-order="4"><a href="/shells/2020.1.0/modeling-the-shell.html">Modeling Shells with TOSCA</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_shells/2020.1.0/generating-shell-data-model.md" data-order="5"><a href="/shells/2020.1.0/generating-shell-data-model.html">Managing the Shell’s Data Model</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_shells/2020.1.0/getting-information-from-cloudshell.md" data-order="6"><a href="/shells/2020.1.0/getting-information-from-cloudshell.html">Getting Information from CloudShell</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_shells/2020.1.0/customizing-driver-commands.md" data-order="7"><a href="/shells/2020.1.0/customizing-driver-commands.html">Commands Visibility and Usability</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_shells/2020.1.0/driver-deep-dive.md" data-order="8"><a href="/shells/2020.1.0/driver-deep-dive.html">Driver Deep Dive</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_shells/2020.1.0/implementing-discovery-for-inventory-shells.md" data-order="9"><a href="/shells/2020.1.0/implementing-discovery-for-inventory-shells.html">Auto-discovery for Inventory Shells</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_shells/2020.1.0/discovering-inventory-snmp.md" data-order="10"><a href="/shells/2020.1.0/discovering-inventory-snmp.html">Discovering Inventory using SNMP</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_shells/2020.1.0/debugging-shell-commands.md" data-order="11"><a href="/shells/2020.1.0/debugging-shell-commands.html">Debugging Shell Driver Commands</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_shells/2020.1.0/deploying-to-production.md" data-order="12"><a href="/shells/2020.1.0/deploying-to-production.html">Deploying to Production</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_shells/2020.1.0/customizing-shells.md" data-order="13"><a href="/shells/2020.1.0/customizing-shells.html">Customizing Shells</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_shells/2020.1.0/common-driver-recipes.md" data-order="14"><a href="/shells/2020.1.0/common-driver-recipes.html">Common Driver Recipes</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_shells/2020.1.0/tips-and-tricks.md" data-order="15"><a href="/shells/2020.1.0/tips-and-tricks.html">Tips and Tricks</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_shells/2020.1.0/sharing-shells-with-community.md" data-order="16"><a href="/shells/2020.1.0/sharing-shells-with-community.html">Sharing a Shell with the Community</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_shells/2020.1.0/1st-gen-shells.md" data-order="17"><a href="/shells/2020.1.0/1st-gen-shells.html">1st Gen Shells</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
        
           <li class="nav-header">Orchestration scripts</li>
			  
           
           
               
			      
					               
               	
                       <li data-page-id="_orchestration/2020.1.0/getting-started.md" data-order="1"><a href="/orchestration/2020.1.0/getting-started.html">Getting Started</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_orchestration/2020.1.0/getting-information-from-cloudshell.md" data-order="2"><a href="/orchestration/2020.1.0/getting-information-from-cloudshell.html">Getting Information from CloudShell</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_orchestration/2020.1.0/script-commands-customization.md" data-order="6"><a href="/orchestration/2020.1.0/script-commands-customization.html">Script commands Visibility and Usability</a></li>
						
					
           
               
			      
					               
               	
                       <li data-page-id="_orchestration/2020.1.0/scripts-deep-dive.md" data-order="6"><a href="/orchestration/2020.1.0/scripts-deep-dive.html">Scripts Deep Dive</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_orchestration/2020.1.0/common-orchestration-recipes.md" data-order="9"><a href="/orchestration/2020.1.0/common-orchestration-recipes.html">Common Orchestration Script Recipes</a></li>
						
					
           
               
			      
					               
               	
                       <li data-page-id="_orchestration/2020.1.0/the-oob-orchestration.md" data-order="9"><a href="/orchestration/2020.1.0/the-oob-orchestration.html">CloudShell's OOB Orchestration</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
        
           <li class="nav-header">Configuration management</li>
			  
           
           
               
			      
					               
               	
                       <li data-page-id="_configmanagement/2020.1.0/cf-overview.md" data-order="1"><a href="/configmanagement/2020.1.0/cf-overview.html">Overview</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_configmanagement/2020.1.0/cf-custom-scripts.md" data-order="2"><a href="/configmanagement/2020.1.0/cf-custom-scripts.html">Custom Scripts</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_configmanagement/2020.1.0/cf-add-custom-script-to-app.md" data-order="3"><a href="/configmanagement/2020.1.0/cf-add-custom-script-to-app.html">Adding Your Script to an App</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_configmanagement/2020.1.0/cf-custom-scripts-tips-and-tricks.md" data-order="4"><a href="/configmanagement/2020.1.0/cf-custom-scripts-tips-and-tricks.html">Tips and Tricks for Custom Scripts</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_configmanagement/2020.1.0/cf-ansible.md" data-order="5"><a href="/configmanagement/2020.1.0/cf-ansible.html">Ansible</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_configmanagement/2020.1.0/cf-ansible-examples.md" data-order="6"><a href="/configmanagement/2020.1.0/cf-ansible-examples.html">Ansible Playbook Examples</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_configmanagement/2020.1.0/cf-add-playbook-to-app.md" data-order="7"><a href="/configmanagement/2020.1.0/cf-add-playbook-to-app.html">Adding the Playbook to an App</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_configmanagement/2020.1.0/cf-ansible-tips-and-tricks.md" data-order="8"><a href="/configmanagement/2020.1.0/cf-ansible-tips-and-tricks.html">Tips and Tricks for Ansible Playbooks</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
        
           <li class="nav-header">Extending cloudshell with cloud providers</li>
			  
           
           
               
			      
					               
               	
                       <li data-page-id="_cloudproviders/2020.1.0/getting-started-with-cloud-providers.md" data-order="1"><a href="/cloudproviders/2020.1.0/getting-started-with-cloud-providers.html">Getting Started with Cloud Providers</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_cloudproviders/2020.1.0/creating-cloud-provider-shell.md" data-order="3"><a href="/cloudproviders/2020.1.0/creating-cloud-provider-shell.html">Creating the Cloud Provider Shell</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_cloudproviders/2020.1.0/the-cloud-provider-model.md" data-order="5"><a href="/cloudproviders/2020.1.0/the-cloud-provider-model.html">The Cloud Provider Model</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_cloudproviders/2020.1.0/extending-cloud-provider-shell-data-model.md" data-order="7"><a href="/cloudproviders/2020.1.0/extending-cloud-provider-shell-data-model.html">Extending the Shell's Data Model</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_cloudproviders/2020.1.0/removing-the-address-field.md" data-order="8"><a href="/cloudproviders/2020.1.0/removing-the-address-field.html">Removing the Address Field</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_cloudproviders/2020.1.0/configuring-deployment-paths.md" data-order="9"><a href="/cloudproviders/2020.1.0/configuring-deployment-paths.html">Configuring Deployment Paths</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_cloudproviders/2020.1.0/controlling-app-deployment-orchestration.md" data-order="11"><a href="/cloudproviders/2020.1.0/controlling-app-deployment-orchestration.html">Controlling App Deployment Orchestration</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_cloudproviders/2020.1.0/the-cloud-provider-interface.md" data-order="13"><a href="/cloudproviders/2020.1.0/the-cloud-provider-interface.html">The Cloud Provider Interface</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_cloudproviders/2020.1.0/resource-discovery.md" data-order="15"><a href="/cloudproviders/2020.1.0/resource-discovery.html">Resource Discovery</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_cloudproviders/2020.1.0/app-deployment.md" data-order="17"><a href="/cloudproviders/2020.1.0/app-deployment.html">App Deployment</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_cloudproviders/2020.1.0/power-off-and-delete.md" data-order="19"><a href="/cloudproviders/2020.1.0/power-off-and-delete.html">Power off and Delete VM</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_cloudproviders/2020.1.0/L2-networking-management.md" data-order="21"><a href="/cloudproviders/2020.1.0/L2-networking-management.html">L2 Network Connectivity</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_cloudproviders/2020.1.0/L3-networking-management.md" data-order="23"><a href="/cloudproviders/2020.1.0/L3-networking-management.html">L3 Network Connectivity</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
        
           <li class="nav-header">Cloudshell apis</li>
			  
           
           
               
			      
					               
               	
                       <li data-page-id="_devops/2020.1.0/available-apis.md" data-order="1"><a href="/devops/2020.1.0/available-apis.html">Available CloudShell APIs</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_devops/2020.1.0/devops-integration.md" data-order="2"><a href="/devops/2020.1.0/devops-integration.html">Automating CloudShell Sandboxes for DevOps</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
        
           <li class="nav-header">Reference</li>
			  
           
           
               
			      
					               
               	
                       <li data-page-id="_reference/2020.1.0/python-coding-standards.md" data-order="3"><a href="/reference/2020.1.0/python-coding-standards.html">Python Coding Standards</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_reference/2020.1.0/shellfoundry-intro.md" data-order="5"><a href="/reference/2020.1.0/shellfoundry-intro.html">Shellfoundry</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_reference/2020.1.0/quali-shell-framework.md" data-order="7"><a href="/reference/2020.1.0/quali-shell-framework.html">Quali’s Shell Framework (Python 2)</a></li>
						
					
           
               
			      
					
           
               
			      
					               
               	
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_reference/2020.1.0/quali-shell-framework-python-3.md" data-order="9"><a href="/reference/2020.1.0/quali-shell-framework-python-3.html">Quali’s Shell Framework (Python 3)</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_reference/2020.1.0/migrating_1st_gen_shells.md" data-order="10"><a href="/reference/2020.1.0/migrating_1st_gen_shells.html">Converting 1st Gen Shells into 2nd Gen</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_reference/2020.1.0/associating-service-categories.md" data-order="11"><a href="/reference/2020.1.0/associating-service-categories.html">Categories in 1st Gen Service Shells</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_reference/2020.1.0/mapping-sub-resource-connections.md" data-order="12"><a href="/reference/2020.1.0/mapping-sub-resource-connections.html">Mapping Connections using App Sub-resources</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_reference/2020.1.0/L1-switch-shell.md" data-order="13"><a href="/reference/2020.1.0/L1-switch-shell.html">L1 Switch Shells</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_reference/2020.1.0/short-dev-videos.md" data-order="14"><a href="/reference/2020.1.0/short-dev-videos.html">Short Development Videos</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_reference/2020.1.0/resource-scripts.md" data-order="15"><a href="/reference/2020.1.0/resource-scripts.html">Resource Scripts</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_reference/2020.1.0/defining-Azure-custom-routing.md" data-order="17"><a href="/reference/2020.1.0/defining-Azure-custom-routing.html">Custom Routing for Azure Apps</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_reference/2020.1.0/working-with-sandbox-metadata.md" data-order="19"><a href="/reference/2020.1.0/working-with-sandbox-metadata.html">Custom Sandbox Metadata</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_reference/2020.1.0/creating-static-vm.md" data-order="21"><a href="/reference/2020.1.0/creating-static-vm.html">Shells that Load a Static VM</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_reference/2020.1.0/intellisense-with-docstrings.md" data-order="23"><a href="/reference/2020.1.0/intellisense-with-docstrings.html">Intellisense in Shells and Scripts (using Docstrings)</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_reference/2020.1.0/aws-traffic-mirroring.md" data-order="25"><a href="/reference/2020.1.0/aws-traffic-mirroring.html">AWS Traffic Mirroring</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_reference/2020.1.0/common-cloudshell-packages.md" data-order="27"><a href="/reference/2020.1.0/common-cloudshell-packages.html">Common CloudShell Packages</a></li>
						
					
           
               
			      
					               
               	
					
           
               
			      
					               
               	
                       <li data-page-id="_reference/2020.1.0/migrating-shells-to-python-3.md" data-order="29"><a href="/reference/2020.1.0/migrating-shells-to-python-3.html">Migrating Shells to Python 3</a></li>
						
					
           
               
			      
					               
               	
					
           
        
</ul>

                    </div>

                    <div id="content" class="col-md-9 col-sm-8">
                        

<div class="page-header" data-page-id="_cloudproviders/2020.1.0/L3-networking-management.md">
    <h2>L3 Network Connectivity
        
        
          
        
    </h2>
</div>

<p>In this article, we’ll learn how to implement L3 network connectivity. Cloudshell recognizes a cloud provider shell as an L3 networking cloud provider if the method <em>PrepareSandboxInfra</em> exists in the shell driver. If the method doesn’t exist, CloudShell considers the shell as an L2 networking shell.</p>

<p>To add support for L3 subnet connectivity in a custom cloud provider, we’ll need to implement 3 methods:</p>

<ul>
  <li><em>PrepareSandboxInfra</em> is used to prepare the infrastructure required  for a sandbox operating with L3 connectivity.</li>
  <li><em>Deploy</em> should be extended to support <em>connetToSubnet</em> action requests.</li>
  <li><em>CleanupSandboxInfra</em> cleans any sandbox-level entities created in the cloud provider, usualy entities created by the <em>PrepareSandboxInfra</em> command. This is the last command to be called in the orchestration flow.</li>
</ul>

<h2 id="preparesandboxinfra-method">PrepareSandboxInfra method</h2>

<p>The <em>PrepareSandboxInfra</em> method is the 1st method to be called in the sandbox setup. It creates the required infrastructure for the sandbox. The network address space of the sandbox is allocated automatically by CloudShell and represented using CIDR notation and provided in the actions request.</p>

<p>It must support these three action types:</p>

<p><em><strong>prepareCloudInfra</strong></em></p>

<p>When handling this action, you need to create/allocate the requested CIDR to the sandbox in your cloud provider. This is also the place to create/allocate cloud resource that will be used by the entire sandbox. For example, an AWS shell might create an S3 bucket that will be used by the entire sandbox, and a shared Security Group, which will be attached to all AWS VM instances, to allow inbound traffic from specific QualiX and Execution Server VM instances for secure connectivity to the VMs and configuration management.</p>

<p>Generally this is the 1st action you should handle before proceeding to other actions. There is always one instance of this type of action.</p>

<p><em><strong>prepareSubnet</strong></em></p>

<p><em>prepareSubnet</em> gets one or more actions from this type. When handling this action, you need to create/allocate a subnet for each action according to the CIDR and <strong>Subnet</strong> service attributes in the blueprint. A subnet can be declared as public or private by the blueprint designer. A subnet is considered private if it is not accessible from outside the sandbox, and is considered public if it is possible to access the subnet from outside the sandbox. As a general best practice, it is recommended to allow outbound traffic from private subnets to elements outside of the sandbox.</p>

<p>CloudShell sends a <em>prepareSubnet</em> action for each <strong>Subnet</strong> service in the blueprint. If there are no <strong>Subnet</strong> services in the blueprint, CloudShell will create a single subnet for the sandbox, by sending a <em>prepareSubnet</em> action with the default values. In a “single subnet” scenario, it is assumed that the sandbox components are all located in the same default subnet. Note that the driver still needs to create/allocate a subnet in “single subnet” mode.</p>

<p>The result for this action must include a <em>subnetId</em> property. This must be an id that can be used to uniquely identify the subnet in the cloud provider. The “subnet id” will be passed as part of <em>connectToSubnet</em> actions in the <em>Deploy</em> method and should be used to identify the subnets that the App wants to connect to.</p>

<p><em><strong>createKey</strong></em></p>

<p>There is always one instance of this type of action. This action type has no metadata. To handle this action, you return an ssh key that will be used by CloudShell to connect to Linux VMs in the sandbox. If you don’t want to use ssh keys, you can simply ignore this action without returning any <em>createKeys</em> action results.</p>

<p>Cloudshell stores the ssh key securely and if the deployed App has an empty password attribute or no password attribute, it will try to authenticate with the VM using the value in the <strong>Username</strong> attribute and the ssh key when using QualiX to ssh to a deployed App.</p>

<p>The <em>Deploy</em> method is responsible to create the VM with the sandbox ssh key that was generated in the <em>prepareSandboxInfra</em> method. Cloudshell does not pass the ssh key to the <em>Deploy</em> method and it’s the responsibility of the shell developer to store this ssh key in a secure place that is accessible during the <em>Deploy</em> method. An example for this implementation for an aws shell is to use an S3 bucket that is used only by the sandbox.</p>

<p><strong>Note:</strong> <em>PrepareSandboxInfra</em> can be called multiple times in a sandbox. Setup can be called multiple times in the sandbox, and every time setup is called, the <em>PrepareSandboxInfra</em> method will be called again. So your implementation needs to support this use case and take under consideration that the cloud resource might already exist. It’s recommended to follow the “get or create” pattern when implementing this method.</p>

<h3 id="called-when">Called when</h3>

<p>This command is called for L3 Networking type implementations in the beginning of the orchestration flow (preparation stage),
even before <em>Deploy</em> is called.</p>

<h3 id="error-handling">Error handling</h3>

<p>If failure occurs, return a “success false” action result.</p>

<h3 id="signature">Signature</h3>

<figure class="highlight"><pre><code class="language-python" data-lang="python">def PrepareSandboxInfra(self, context, request, cancellation_context)</code></pre></figure>

<h3 id="inputs">Inputs</h3>

<p><strong>context:</strong> <em>context</em> is a <em>ResourceCommandContext</em> object that contains:</p>

<ol>
  <li>connectivity - CloudShell server connectivity data for authentication with CloudShell Automation API</li>
  <li>resource - resource configuration settings entered when creating the Cloud Provider resource in the <strong>Inventory</strong> dashboard</li>
  <li>reservation - current reservation details</li>
  <li>connectors – details of any visual connectors between the Cloud Provider App and other endppoints in the sandbox.</li>
</ol>

<div class="github-sample-reference">
  <div class="author-info">
    <a href="https://github.com/QualiSystems/cloudshell-shell-core/blob/36009fdec45134ae38cb9273328b7686be66e553/cloudshell/shell/core/driver_context.py">This Github Sample</a> is by <a href="https://github.com/QualiSystems">QualiSystems</a>
  </div>
  <div class="meta-info">
    cloudshell/shell/core/driver_context.py <a href="https://github.com/QualiSystems/cloudshell-shell-core/blob/36009fdec45134ae38cb9273328b7686be66e553/cloudshell/shell/core/driver_context.py">view</a> <a href="https://raw.githubusercontent.com/QualiSystems/cloudshell-shell-core/36009fdec45134ae38cb9273328b7686be66e553/cloudshell/shell/core/driver_context.py">raw</a>
  </div>
</div>

<figure class="highlight"><pre><code class="language-python" data-lang="python">class ResourceCommandContext:
    def __init__(self, connectivity, resource, reservation, connectors):
        self.connectivity = connectivity  # Connectivity details that can help connect to the APIs
        &quot;&quot;&quot;:type : ConnectivityContext&quot;&quot;&quot;
        self.resource = resource  # The details of the resource using the driver
        &quot;&quot;&quot;:type : ResourceContextDetails&quot;&quot;&quot;
        self.reservation = reservation  # The details of the reservation
        &quot;&quot;&quot;:type : ReservationContextDetails&quot;&quot;&quot;
        self.connectors = connectors  # The list of visual connectors and routes that are connected to the resource (the resource will be considered as the source end point)
        &quot;&quot;&quot;:type : list[Connector]&quot;&quot;&quot;</code></pre></figure>

<p>Here’s a code sample that extracts the cloud provider data from the <em>context</em>:</p>

<figure class="highlight"><pre><code class="language-python" data-lang="python">cloud_provider_resource = HeavenlyCloudsShell.create_from_context(context)</code></pre></figure>

<p><strong>Request</strong></p>

<p>JSON string that contains the requested actions.</p>

<p><strong>Cancelation context</strong></p>

<div class="github-sample-reference">
  <div class="author-info">
    <a href="https://github.com/QualiSystems/cloudshell-shell-core/blob/36009fdec45134ae38cb9273328b7686be66e553/cloudshell/shell/core/driver_context.py">This Github Sample</a> is by <a href="https://github.com/QualiSystems">QualiSystems</a>
  </div>
  <div class="meta-info">
    cloudshell/shell/core/driver_context.py <a href="https://github.com/QualiSystems/cloudshell-shell-core/blob/36009fdec45134ae38cb9273328b7686be66e553/cloudshell/shell/core/driver_context.py">view</a> <a href="https://raw.githubusercontent.com/QualiSystems/cloudshell-shell-core/36009fdec45134ae38cb9273328b7686be66e553/cloudshell/shell/core/driver_context.py">raw</a>
  </div>
</div>

<figure class="highlight"><pre><code class="language-python" data-lang="python">def __init__(self):
    self.is_cancelled = False
    &quot;&quot;&quot;:type : bool&quot;&quot;&quot;</code></pre></figure>

<h3 id="preparesandboxinfra-method-implementation">PrepareSandboxInfra method implementation</h3>

<p> 1.	<a href="https://github.com/QualiSystems/Custom-L2-Cloud-Provider-Shell-Example/blob/a9a14e87570fdc52d9994950e161b104c62401fb/src/driver.py#L91" target="_blank">Retrieve the cloud provider resource connection credentials</a>.</p>

<p> 2.	<a href="https://github.com/QualiSystems/Custom-L3-Cloud-Provider-Shell-Example/blob/6f62a52ca2a66b8f37bf4d2364c92ec8dc89c383/src/driver.py#L248-L258" target="_blank">Retrieve requested actions (1 PrepareCloudInfra, 1 CreateKeys, &gt;=1 PrepareSubnet)</a>.</p>

<p>     a.	<a href="https://github.com/QualiSystems/Custom-L3-Cloud-Provider-Shell-Example/blob/6f62a52ca2a66b8f37bf4d2364c92ec8dc89c383/src/heavenly_cloud_service_wrapper.py#L429-L443" target="_blank">Handle <em>PrepareCloudInfra</em></a>.</p>

<p>     b.	<a href="https://github.com/QualiSystems/Custom-L3-Cloud-Provider-Shell-Example/blob/6f62a52ca2a66b8f37bf4d2364c92ec8dc89c383/src/heavenly_cloud_service_wrapper.py#L447-L456" target="_blank">Optionally, handle <em>CreateKeys</em></a>.</p>

<p>     c.	<a href="https://github.com/QualiSystems/Custom-L3-Cloud-Provider-Shell-Example/blob/6f62a52ca2a66b8f37bf4d2364c92ec8dc89c383/src/heavenly_cloud_service_wrapper.py#L460-L471" target="_blank">Handle the <em>PrepareSubnet</em> action(s)</a>.</p>

<p>     d.	<a href="https://github.com/QualiSystems/Custom-L3-Cloud-Provider-Shell-Example/blob/6f62a52ca2a66b8f37bf4d2364c92ec8dc89c383/src/heavenly_cloud_service_wrapper.py#L475" target="_blank">Return the action results</a>.</p>

<p> 3.	<a href="https://github.com/QualiSystems/Custom-L3-Cloud-Provider-Shell-Example/blob/6f62a52ca2a66b8f37bf4d2364c92ec8dc89c383/src/driver.py#L260-L269" target="_blank">Return the driver’s response</a>.</p>

<h2 id="deploy-method-with-l3-connectivity">Deploy method with L3 connectivity</h2>

<p>When working with L3 connectivity, the subnets and shared sandbox resources are created in the <em>PrepareSandboxInfra</em> method. The <em>Deploy</em> method is executed only after <em>PrepareSandboxInfra</em> completes successfully. <em>Deploy</em> can receive 0 or more <em>connectToSubnet</em> actions in addition to the single <em>deployApp</em> action. The <em>connectToSubnet</em> actions tell the VM that we are creating the subnets that the VM should be connected to. The <strong>subnetId</strong> property in the <em>connectToSubnet</em> action should be used to uniquely identify the subnet in the cloud provider.</p>

<p>The <em>connectToSubnet</em> action contains a special property called <strong>vnicName</strong>. When this property contains a value, it means that the blueprint designer specified a request from the cloud provider shell to create a connection on a specific network interface. For example, if the <strong>vnicName</strong> value is 1, we need to create the network interface for the relevant subnet from the action on eth1.</p>

<p><strong>Note:</strong> In case the shell supports ssh key authentications for linux vms it’s the responsibility of the deploy method implementation to get the ssh key created during prepareSandboxInfra. Cloudshell will not send the ssh key to the deploy method in the request.</p>

<h3 id="l3-deploy-method-implementation">L3 Deploy method implementation</h3>

<p>In L3, the <em>Deploy</em> method should perform the following steps:</p>

<p> 1. <a href="https://github.com/QualiSystems/Custom-L2-Cloud-Provider-Shell-Example/blob/a9a14e87570fdc52d9994950e161b104c62401fb/src/driver.py#L91" target="_blank">Retrieve the cloud provider resource connection credentials</a>.</p>

<p> 2. <a href="https://github.com/QualiSystems/Custom-L3-Cloud-Provider-Shell-Example/blob/f26b3b5d92da04ecfac1238aa8334ba86a89a301/src/driver.py#L92-L95" target="_blank">Retrieve the <em>Deploy</em> action</a>.</p>

<p> 3. <a href="https://github.com/QualiSystems/Custom-L3-Cloud-Provider-Shell-Example/blob/f26b3b5d92da04ecfac1238aa8334ba86a89a301/src/driver.py#L97-L98" target="_blank">Retrieve <em>CononectToSubnetActions</em></a>.</p>

<p> 4. <a href="https://github.com/QualiSystems/Custom-L3-Cloud-Provider-Shell-Example/blob/f26b3b5d92da04ecfac1238aa8334ba86a89a301/src/driver.py#L100-L117" target="_blank">Call the <em>Deploy</em> logic of the selected deployment type</a>.</p>

<p>     a. <a href="https://github.com/QualiSystems/Custom-L3-Cloud-Provider-Shell-Example/blob/6f62a52ca2a66b8f37bf4d2364c92ec8dc89c383/src/heavenly_cloud_service_wrapper.py#L118" target="_blank">(Steps 4-a to -4-e are performed by the <em>Deploy</em> logic) Generate a unique App name</a>.</p>

<p>     b. <a href="https://github.com/QualiSystems/Custom-L3-Cloud-Provider-Shell-Example/blob/f26b3b5d92da04ecfac1238aa8334ba86a89a301/src/sdk/heavenly_cloud_service.py#L105-L123" target="_blank">Create the network configuration plan to use when calling the cloud provider SDK VM instance deploy</a>.</p>

<p>     c. <a href="https://github.com/QualiSystems/Custom-L3-Cloud-Provider-Shell-Example/blob/47e55422d3ef155fc6d126ee75be5d85be909496/src/heavenly_cloud_service_wrapper.py#L136-L142" target="_blank">Create the VM instance using the deployment path attributes and network plan</a>.</p>

<p>     d. If <em>Deploy</em> succeeds, do the following:</p>

<p>          i.	<a href="https://github.com/QualiSystems/Custom-L3-Cloud-Provider-Shell-Example/blob/47e55422d3ef155fc6d126ee75be5d85be909496/src/heavenly_cloud_service_wrapper.py#L146-L147" target="_blank">Collect the VM’s details (operating system, specifications, networking information)</a>.</p>

<p>          ii.	<a href="https://github.com/QualiSystems/Custom-L3-Cloud-Provider-Shell-Example/blob/47e55422d3ef155fc6d126ee75be5d85be909496/src/heavenly_cloud_service_wrapper.py#L165-L169" target="_blank">Create <em>ConnectToSubnet</em> results</a>.</p>

<p>     e. <a href="https://github.com/QualiSystems/Custom-L3-Cloud-Provider-Shell-Example/blob/47e55422d3ef155fc6d126ee75be5d85be909496/src/heavenly_cloud_service_wrapper.py#L173" target="_blank">Return results</a>.</p>

<p> 5. <a href="https://github.com/QualiSystems/Custom-L3-Cloud-Provider-Shell-Example/blob/47e55422d3ef155fc6d126ee75be5d85be909496/src/driver.py#L122" target="_blank">Return the driver’s response</a>.</p>

<h2 id="cleanupsandboxinfra">CleanupSandboxInfra</h2>

<p>This method is responsible for cleaning any sandbox-level entities created in the cloud provider, usually entities created in the <em>PrepareSandboxInfra</em> command.</p>

<h3 id="called-when-1">Called When</h3>

<p>This method is the last method to be called during the sandbox’s teardown (before the sandbox is completed).</p>

<h3 id="error-handling-1">Error handling</h3>

<p>If a failure occurs, return a “success false” action result.</p>

<h3 id="signature-1">Signature</h3>

<figure class="highlight"><pre><code class="language-python" data-lang="python">def CleanupSandboxInfra(self, context, request):</code></pre></figure>

<h3 id="inputs-1">Inputs</h3>

<p><strong>context:</strong> <em>context</em> is a <em>ResourceCommandContext</em> object that contains:</p>

<ol>
  <li>connectivity - CloudShell server connectivity data for authentication with CloudShell Automation API</li>
  <li>resource - resource configuration settings entered when creating the Cloud Provider resource in the <strong>Inventory</strong> dashboard</li>
  <li>reservation - current reservation details</li>
  <li>connectors – details of any visual connectors between the Cloud Provider App and other endppoints in the sandbox.</li>
</ol>

<div class="github-sample-reference">
  <div class="author-info">
    <a href="https://github.com/QualiSystems/cloudshell-shell-core/blob/36009fdec45134ae38cb9273328b7686be66e553/cloudshell/shell/core/driver_context.py">This Github Sample</a> is by <a href="https://github.com/QualiSystems">QualiSystems</a>
  </div>
  <div class="meta-info">
    cloudshell/shell/core/driver_context.py <a href="https://github.com/QualiSystems/cloudshell-shell-core/blob/36009fdec45134ae38cb9273328b7686be66e553/cloudshell/shell/core/driver_context.py">view</a> <a href="https://raw.githubusercontent.com/QualiSystems/cloudshell-shell-core/36009fdec45134ae38cb9273328b7686be66e553/cloudshell/shell/core/driver_context.py">raw</a>
  </div>
</div>

<figure class="highlight"><pre><code class="language-python" data-lang="python">class ResourceCommandContext:
    def __init__(self, connectivity, resource, reservation, connectors):
        self.connectivity = connectivity  # Connectivity details that can help connect to the APIs
        &quot;&quot;&quot;:type : ConnectivityContext&quot;&quot;&quot;
        self.resource = resource  # The details of the resource using the driver
        &quot;&quot;&quot;:type : ResourceContextDetails&quot;&quot;&quot;
        self.reservation = reservation  # The details of the reservation
        &quot;&quot;&quot;:type : ReservationContextDetails&quot;&quot;&quot;
        self.connectors = connectors  # The list of visual connectors and routes that are connected to the resource (the resource will be considered as the source end point)
        &quot;&quot;&quot;:type : list[Connector]&quot;&quot;&quot;</code></pre></figure>

<p><strong>Request</strong></p>

<p>JSON string contains single <em>CleanupSandboxInfra</em> action.</p>

<h3 id="cleanupsandboxinfra-method-implementation">CleanupSandboxInfra method implementation</h3>

<p> 1. <a href="https://github.com/QualiSystems/Custom-L3-Cloud-Provider-Shell-Example/blob/4666a14a0634e82a01692a60a3da1314cd4d863c/src/driver.py#L284" target="_blank">Retrieve the cloud provider resource connection credentials</a>.</p>

<p> 2. <a href="https://github.com/QualiSystems/Custom-L3-Cloud-Provider-Shell-Example/blob/4666a14a0634e82a01692a60a3da1314cd4d863c/src/driver.py#L286-L290" target="_blank">Retrieve the <em>CleanupSandboxInfra</em> action</a>.</p>

<p>     * <a href="https://github.com/QualiSystems/Custom-L3-Cloud-Provider-Shell-Example/blob/4666a14a0634e82a01692a60a3da1314cd4d863c/src/heavenly_cloud_service_wrapper.py#L477-L479" target="_blank">Clean the sandbx-created infrastructure resources and return a success result</a>.</p>

<p> 3. <a href="https://github.com/QualiSystems/Custom-L3-Cloud-Provider-Shell-Example/blob/4666a14a0634e82a01692a60a3da1314cd4d863c/src/driver.py#L296" target="_blank">Return result</a>.</p>









    <div id="post-nav" class="clearfix">
        
            <a class="prev" href="/cloudproviders/2020.1.0/L2-networking-management.html">&laquo; L2 Network Connectivity</a>
        
        
    </div>




<div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
        var disqus_identifier = '_cloudproviders/2020.1.0/L3-networking-management.md';
        var disqus_url = 'https://devguide.quali.com/cloudproviders/2020.1.0/L3-networking-management.html';
        this.page.url = "https://devguide.quali.com/cloudproviders/2020.1.0/L3-networking-management.html";  // Replace PAGE_URL with your page's canonical URL variable
        this.page.identifier = disqus_identifier; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    (function() {  // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');

        s.src = '//qualidev.disqus.com/embed.js';

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>






<ul >
    
</ul>


<script src="/js/search.js" type="text/javascript" charset="utf-8"></script>

<script type="text/javascript">
  $(function() {
    $('#search-query').lunrSearch({
      indexUrl  : '/js/index.json',           // url for the .json file containing search index data
      results   : '#search-results',          // selector for containing search results element
      template  : '#search-results-template', // selector for Mustache.js template
      titleMsg  : '',   // message attached in front of results (can be empty)
      emptyMsg  : '<p>Nothing found.</p>'     // shown message if search returns no results
    });
  });
</script>

<script>
$(function() {
    page = $(".page-header").attr("data-page-id")
    nav_item = $(".nav li[data-page-id='"+page+"']")
    if (nav_item) {
        $(".nav").find(".active").removeClass("active");
        nav_item.addClass("active");
    }
})
</script>

                    </div>
                
            </div>

            

            <div class="row">
                <div id="footer" class="col-sm-12">
                    
<div class="qs-control-container scroll-enable">
	<a href="https://github.com/QualiSystems/devguide_source/issues/new?title=New%20suggestion%20for%20/cloudproviders/2020.1.0/L3-networking-management.html" target="_blank" class="qs-btn-round qs-btn-mail" title="Send feedback">
	</a>

	<button class="qs-btn-round qs-btn-scroll-top tooltip tooltipstered">
	</button>
</div>


Documentation for <a href="http://www.quali.com">CloudShell Developer Guide</a>

                </div>
            </div>
        </div>

        <script src="/js/prism.js"></script>
        
        <script>
 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
 (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
 m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
 })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

 ga('create', 'UA-81468206-1', 'auto');
 ga('send', 'pageview');

</script>

        
    </body>

</html>
